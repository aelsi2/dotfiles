#!/usr/bin/env python3
FUZZEL_CONFIG_PATH = "~/.config/fuzzel/powermenu.ini"
POWER_OPTIONS = [
    ("Shut down", "system-shutdown", ["systemctl", "poweroff"]),
    ("Reboot", "system-reboot", ["systemctl", "reboot"]),
    ("Suspend", "system-suspend", ["systemctl", "suspend"]),
    ("Lock screen", "system-lock-screen", ["swaylock", "-f"]),
    ("Log out", "system-log-out", ["hyprctl", "dispatch", "exit"]),
]

import subprocess
import os

def get_name_with_icon(power_option):
    if power_option[0] == None:
        return power_option[0]
    return power_option[0] + "\0icon\x1f" + power_option[1]

result = subprocess.run(
    [ 
        "fuzzel",    
        "--dmenu",   
        "--config",  
        os.path.expanduser(FUZZEL_CONFIG_PATH)
    ],
    input = "\n".join([get_name_with_icon(tup) for tup in POWER_OPTIONS]).encode(),
    stdout = subprocess.PIPE
).stdout.decode().strip()

result_option = next((tup for tup in POWER_OPTIONS if tup[0] == result), None)

if result_option:
    subprocess.run(result_option[2])
